!function(){"use strict";var e={};function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var n=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._lang=-1!==["fr","es","de"].indexOf(navigator.language)?navigator.language:"en",this._nls=null,this._band=null,this._version="0.2.0",this._fetchLang().then(this._fetchBandInfo.bind(this)).then(this._init.bind(this)).catch((function(e){console.error("BandWebsite v".concat(t._version," : Fatal error during initialization, please contact support :\n"),e)})).finally((function(){}))}var n,r;return n=e,(r=[{key:"_fetchLang",value:function(){var e=this;return new Promise((function(t,n){fetch("assets/json/".concat(e._lang,".json")).then((function(r){r.json().then((function(n){e._nls=n,t()})).catch((function(e){n(e)}))})).catch((function(e){n(e)}))}))}},{key:"_fetchBandInfo",value:function(){var e=this;return new Promise((function(t,n){fetch("assets/json/band.json").then((function(r){r.json().then((function(n){e._band=n,t()})).catch((function(e){n(e)}))})).catch((function(e){n(e)}))}))}},{key:"_init",value:function(){var e=this;return new Promise((function(t,n){"index"===document.body.dataset.type?e._buildIndexPage():"listen"===document.body.dataset.type?e._buildListenPage():"tree"===document.body.dataset.type?e._buildTreePage():n(new Error("Invalid <body> type. Should be either index, listen or tree")),t()}))}},{key:"_buildIndexPage",value:function(){document.querySelector("#band-desc").innerHTML=this._nls.band.desc,document.querySelector("#listen-link").innerHTML=this._nls.listenLink,document.querySelector("#tree-link").innerHTML=this._nls.treeLink;for(var e=document.getElementById("artists"),t=0;t<e.children.length;++t)e.children[t].addEventListener("click",this._artistModal.bind(this,e.children[t].dataset.artist));new window.ScrollBar({target:document.body})}},{key:"_buildListenPage",value:function(){var e=this;document.querySelector("#release-from").innerHTML=this._nls.from,document.querySelector("#listen-online").innerHTML=this._nls.listenOnline,document.querySelector("#see-more-links").innerHTML=this._nls.seeMore,document.querySelector("#published-on").innerHTML=this._nls.publishedOn;var t=document.getElementById("current-progress"),n=document.getElementById("modal-overlay"),r=new Audio,i=0,a=function(){r.pause(),r.currentTime=0,t.style.width="0";var n=e._band.releases[i];document.getElementById("release-background").style.backgroundImage="url('assets/img/releases/".concat(n.cover,"')"),document.getElementById("release-background-bottom").style.backgroundImage="url('assets/img/releases/".concat(n.cover,"')"),document.getElementById("release-cover").src="assets/img/releases/".concat(n.cover),document.getElementById("release-duration").innerHTML=n.duration,document.getElementById("release-title").innerHTML=n.title,document.getElementById("release-artist").innerHTML=n.artist,document.getElementById("release-date").innerHTML=e._buildReleaseDate(n.date),document.getElementById("label-link").innerHTML=n.label,document.getElementById("label-link").href=n.labelLink;for(var a=0;a<n.links.length;++a)""===n.links[a].url?document.getElementById(n.links[a].type).classList.add("disabled"):(document.getElementById(n.links[a].type).classList.remove("disabled"),document.getElementById(n.links[a].type).href=n.links[a].url);document.getElementById("release-tracklist").innerHTML=e._buildTrackCredits(n.tracks),document.getElementById("release-tracklist").scrollHeight>document.getElementById("release-tracklist").clientHeight&&(document.getElementById("release-tracklist").style.display="inherit",new window.ScrollBar({target:document.getElementById("release-tracklist")})),r=new Audio("assets/audio/".concat(n.audio)),s(r)},s=function(){var e=document.getElementById("play-pause");e.src="assets/img/controls/play.svg";var t=document.getElementById("progress-bar"),n=document.getElementById("current-progress"),i=!1;e.addEventListener("click",(function(){!0===i?(i=!1,e.src="assets/img/controls/play.svg",r.pause()):(i=!0,e.src="assets/img/controls/pause.svg",r.play())})),r.addEventListener("timeupdate",(function(){n.style.width="".concat(r.currentTime/r.duration*100,"%")})),r.addEventListener("ended",(function(){r.currentTime=0,n.style.width="0",e.src="assets/img/controls/play.svg",i=!1})),t.addEventListener("click",(function(e){if(!0===i){var a=t.getBoundingClientRect();r.currentTime=(e.clientX-a.left)/a.width*r.duration,n.style.width="".concat(r.currentTime/r.duration*100,"%")}}))};1===this._band.releases.length?(document.getElementById("release-previous").style.display="none",document.getElementById("release-next").style.display="none"):(document.getElementById("release-previous").addEventListener("click",(function(t){t.target.blur(),i=(e._band.releases.length+i-1)%e._band.releases.length,a()})),document.getElementById("release-next").addEventListener("click",(function(t){t.target.blur(),i=(i+1)%e._band.releases.length,a()}))),document.getElementById("modal-overlay").addEventListener("click",(function(){n.style.opacity=0,setTimeout((function(){n.innerHTML="",n.style.display="none"}),400)})),document.getElementById("see-more-links").addEventListener("click",(function(){fetch("assets/html/seemoremodal.html").then((function(t){n.style.display="flex",t.text().then((function(t){n.appendChild(document.createRange().createContextualFragment(t));for(var r=e._band.releases[i],a=0;a<r.moreLinks.length;++a)""===r.moreLinks[a].url?document.getElementById(r.moreLinks[a].type).classList.add("disabled"):(document.getElementById(r.moreLinks[a].type).classList.remove("disabled"),document.getElementById(r.moreLinks[a].type).href=r.moreLinks[a].url);requestAnimationFrame((function(){return n.style.opacity=1}))}))})).catch((function(e){return console.error(e)}))})),a()}},{key:"_buildTreePage",value:function(){for(var e=0;e<this._band.links.length;++e)document.querySelector("#link-wrapper").innerHTML+='\n      <a href="'.concat(this._band.links[e].url,'" class="link" target="_blank" rel="noopener noreferrer">\n        <img src="assets/img/logo/').concat(this._band.links[e].type,'.svg" width="25px">\n        <p>').concat(this._band.links[e].name,"</p>\n      </a>\n      ");new window.ScrollBar({target:document.getElementById("link-wrapper")})}},{key:"_artistModal",value:function(e){var t=document.getElementById("modal-overlay"),n=-1!==["de","es"].indexOf(this._lang)?"en":this._lang;document.getElementById("modal-overlay").addEventListener("click",(function(){t.style.opacity=0,setTimeout((function(){t.innerHTML="",t.style.display="none"}),400)})),fetch("assets/html/".concat(n,"/").concat(e,".html")).then((function(e){t.style.display="flex",e.text().then((function(e){t.appendChild(document.createRange().createContextualFragment(e)),requestAnimationFrame((function(){return t.style.opacity=1}))}))})).catch((function(e){return console.error(e)}))}},{key:"_buildReleaseDate",value:function(e){var t=e.split("-");return"en"===this._lang?"".concat(this._nls.months[t[1]-1]," ").concat(t[0].replace(/^0+/,""),", ").concat(t[2]):"".concat(t[0].replace(/^0+/,"")," ").concat(this._nls.months[t[1]-1]," ").concat(t[2])}},{key:"_buildTrackCredits",value:function(e){for(var t="",n=0;n<e.length;++n)t+="<h3>".concat(n+1,". ").concat(e[n].title," â€“ ").concat(e[n].duration,"</h3><p>"),""!==e[n].composer&&(t+="<i>".concat(this._nls.composer,"</i> : ").concat(e[n].composer,"<br>")),""!==e[n].author&&(t+="<i>".concat(this._nls.author,"</i> : ").concat(e[n].author)),t+="</p>";return t}}])&&t(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),e}();e.default=n,window.BW=e.default}();