!function(){"use strict";var e={};function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var n=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._lang=-1!==["fr","es","de"].indexOf(navigator.language.substring(0,2))?navigator.language.substring(0,2):"en",this._nls=null,this._band=null,this._version="0.2.1",this._fetchLang().then(this._fetchBandInfo.bind(this)).then(this._init.bind(this)).catch((function(e){console.error("BandWebsite v".concat(t._version," : Fatal error during initialization, please contact support :\n"),e)})).finally((function(){}))}var n,i;return n=e,(i=[{key:"_fetchLang",value:function(){var e=this;return new Promise((function(t,n){fetch("assets/json/".concat(e._lang,".json")).then((function(i){i.json().then((function(n){e._nls=n,t()})).catch((function(e){n(e)}))})).catch((function(e){n(e)}))}))}},{key:"_fetchBandInfo",value:function(){var e=this;return new Promise((function(t,n){fetch("assets/json/band.json").then((function(i){i.json().then((function(n){e._band=n,t()})).catch((function(e){n(e)}))})).catch((function(e){n(e)}))}))}},{key:"_init",value:function(){var e=this;return new Promise((function(t,n){"index"===document.body.dataset.type?e._buildIndexPage():"listen"===document.body.dataset.type?e._buildListenPage():"tree"===document.body.dataset.type?e._buildTreePage():n(new Error("Invalid <body> type. Should be either index, listen or tree")),t()}))}},{key:"_buildIndexPage",value:function(){document.querySelector("#band-desc").innerHTML=this._nls.band.desc,document.querySelector("#listen-link").innerHTML='<img src="/assets/img/controls/disc.svg" alt="listen">'.concat(this._nls.listenLink),document.querySelector("#tree-link").innerHTML='<img src="/assets/img/controls/find.svg" alt="listen">'.concat(this._nls.treeLink);for(var e=document.getElementsByClassName("learn-more"),t=0;t<e.length;++t)e[t].innerHTML=this._nls.learnMore;for(var n=document.getElementById("artists"),i=0;i<n.children.length;++i)n.children[i].addEventListener("click",this._artistModal.bind(this,n.children[i].dataset.artist));for(var r=document.getElementById("releases"),s=0;s<r.children.length;++s)r.children[s].addEventListener("click",this._openReleaseVideo.bind(this,r.children[s].dataset.url));new window.ScrollBar({target:document.body})}},{key:"_buildListenPage",value:function(){var e=this;document.querySelector("#release-from").innerHTML=this._nls.from,document.querySelector("#listen-online").innerHTML=this._nls.listenOnline,document.querySelector("#see-more-links").innerHTML=this._nls.seeMore,document.querySelector("#published-on").innerHTML=this._nls.publishedOn;var t=document.getElementById("current-progress"),n=document.getElementById("modal-overlay"),i=new Audio,r=0,s=function(){i.pause(),i.currentTime=0,t.style.width="0";var n=e._band.releases[r];document.getElementById("release-background").style.backgroundImage="url('assets/img/releases/".concat(n.cover,"')"),document.getElementById("release-background-bottom").style.backgroundImage="url('assets/img/releases/".concat(n.cover,"')"),document.getElementById("release-cover").src="assets/img/releases/".concat(n.cover),document.getElementById("release-duration").innerHTML=n.duration,document.getElementById("release-title").innerHTML=n.title,document.getElementById("release-artist").innerHTML=n.artist,document.getElementById("release-date").innerHTML=e._buildReleaseDate(n.date),document.getElementById("label-link").innerHTML=n.label,document.getElementById("label-link").href=n.labelLink;for(var s=0;s<n.links.length;++s)""===n.links[s].url?document.getElementById(n.links[s].type).classList.add("disabled"):(document.getElementById(n.links[s].type).classList.remove("disabled"),document.getElementById(n.links[s].type).href=n.links[s].url);document.getElementById("release-tracklist").innerHTML=e._buildTrackCredits(n.tracks),document.getElementById("release-tracklist").scrollHeight>document.getElementById("release-tracklist").clientHeight&&(document.getElementById("release-tracklist").style.display="inherit",new window.ScrollBar({target:document.getElementById("release-tracklist")})),i=new Audio("assets/audio/".concat(n.audio)),a(i)},a=function(){var e=document.getElementById("play-pause");e.src="assets/img/controls/play.svg";var t=document.getElementById("progress-bar"),n=document.getElementById("current-progress"),r=!1;e.addEventListener("click",(function(){!0===r?(r=!1,e.src="assets/img/controls/play.svg",i.pause()):(r=!0,e.src="assets/img/controls/pause.svg",i.play())})),i.addEventListener("timeupdate",(function(){n.style.width="".concat(i.currentTime/i.duration*100,"%")})),i.addEventListener("ended",(function(){i.currentTime=0,n.style.width="0",e.src="assets/img/controls/play.svg",r=!1})),t.addEventListener("click",(function(e){if(!0===r){var s=t.getBoundingClientRect();i.currentTime=(e.clientX-s.left)/s.width*i.duration,n.style.width="".concat(i.currentTime/i.duration*100,"%")}}))};1===this._band.releases.length?(document.getElementById("release-previous").style.display="none",document.getElementById("release-next").style.display="none"):(document.getElementById("release-previous").addEventListener("click",(function(t){t.target.blur(),r=(e._band.releases.length+r-1)%e._band.releases.length,s()})),document.getElementById("release-next").addEventListener("click",(function(t){t.target.blur(),r=(r+1)%e._band.releases.length,s()}))),document.getElementById("modal-overlay").addEventListener("click",(function(){n.style.opacity=0,setTimeout((function(){n.innerHTML="",n.style.display="none"}),400)})),document.getElementById("see-more-links").addEventListener("click",(function(){fetch("assets/html/seemoremodal.html").then((function(t){n.style.display="flex",t.text().then((function(t){n.appendChild(document.createRange().createContextualFragment(t));for(var i=e._band.releases[r],s=0;s<i.moreLinks.length;++s)""===i.moreLinks[s].url?document.getElementById(i.moreLinks[s].type).classList.add("disabled"):(document.getElementById(i.moreLinks[s].type).classList.remove("disabled"),document.getElementById(i.moreLinks[s].type).href=i.moreLinks[s].url);requestAnimationFrame((function(){return n.style.opacity=1}))}))})).catch((function(e){return console.error(e)}))})),s()}},{key:"_buildTreePage",value:function(){for(var e=0;e<this._band.links.length;++e)document.querySelector("#link-wrapper").innerHTML+='\n      <a href="'.concat(this._band.links[e].url,'" class="link" target="_blank" rel="noopener noreferrer">\n        <img src="assets/img/logo/').concat(this._band.links[e].type,'.svg" width="25px">\n        <p>').concat(this._band.links[e].name,"</p>\n      </a>\n      ");new window.ScrollBar({target:document.getElementById("link-wrapper")})}},{key:"_artistModal",value:function(e){var t=document.getElementById("modal-overlay"),n=-1!==["de","es"].indexOf(this._lang)?"en":this._lang;document.getElementById("modal-overlay").addEventListener("click",(function(){t.style.opacity=0,setTimeout((function(){t.innerHTML="",t.style.display="none"}),400)})),fetch("assets/html/".concat(n,"/").concat(e,".html")).then((function(e){t.style.display="flex",e.text().then((function(e){t.appendChild(document.createRange().createContextualFragment(e)),requestAnimationFrame((function(){return t.style.opacity=1}))}))})).catch((function(e){return console.error(e)}))}},{key:"_openReleaseVideo",value:function(e){window.open(e,"_blank").focus()}},{key:"_buildReleaseDate",value:function(e){var t=e.split("-");return"en"===this._lang?"".concat(this._nls.months[t[1]-1]," ").concat(t[0].replace(/^0+/,""),", ").concat(t[2]):"".concat(t[0].replace(/^0+/,"")," ").concat(this._nls.months[t[1]-1]," ").concat(t[2])}},{key:"_buildTrackCredits",value:function(e){for(var t="",n=0;n<e.length;++n)t+="<h3>".concat(n+1,". ").concat(e[n].title," â€“ ").concat(e[n].duration,"</h3><p>"),""!==e[n].composer&&(t+="<i>".concat(this._nls.composer,"</i> : ").concat(e[n].composer,"<br>")),""!==e[n].author&&(t+="<i>".concat(this._nls.author,"</i> : ").concat(e[n].author)),t+="</p>";return t}}])&&t(n.prototype,i),Object.defineProperty(n,"prototype",{writable:!1}),e}();e.default=n,window.BW=e.default}();